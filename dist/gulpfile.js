"use strict";global.dataPath={root:"./"};var fs=require("fs"),gulp=require("gulp"),rimraf=require("rimraf"),plugins=require("gulp-load-plugins")(),path=require("path"),babel=require("gulp-babel"),outputDir="dist",output=global.dataPath.root+"/"+outputDir;gulp.task("connect",function(){plugins.connect.server({name:"website",root:global.dataPath.root,port:8088,livereload:!0})}),gulp.task("delDist",function(t){return rimraf(output,t)}),gulp.task("minify_html",function(){return gulp.src([global.dataPath.root+"/**/*.html","!"+global.dataPath.root+"/template/*.html"],{base:global.dataPath.root}).pipe(plugins.htmlclean()).pipe(plugins.htmlmin({removeComments:!0,collapseWhitespace:!0,minifyJS:!1,minifyCSS:!0,minifyURLs:!0})).pipe(gulp.dest(output))}),gulp.task("minify_css",function(){return gulp.src([global.dataPath.root+"/**/*.css"],{base:global.dataPath.root}).pipe(plugins.cleanCss()).pipe(gulp.dest(output))}),gulp.task("minify_js",function(){return gulp.src([global.dataPath.root+"/**/*.js"],{base:global.dataPath.root}).pipe(babel({presets:["@babel/env"]})).pipe(plugins.uglify()).on("error",function(t){plugins.util.log(plugins.util.colors.red("[Error]"),t.toString())}).pipe(gulp.dest(output))}),gulp.task("copy_file",function(){return gulp.src([global.dataPath.root+"/**/*.ico",global.dataPath.root+"/images/*.*",global.dataPath.root+"/images/**/*.*",global.dataPath.root+"/data/*.*"],{base:global.dataPath.root}).pipe(gulp.dest(output))}),gulp.task("build",function(t){plugins.sequence("delDist",["minify_html","minify_css","minify_js","copy_file"],t)}),gulp.task("default",function(){gulp.start("connect")});